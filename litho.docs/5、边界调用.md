# System Boundary Interface Documentation

This document describes the system's external invocation interfaces, including CLI commands, API endpoints, configuration parameters, and other boundary mechanisms.

## Command Line Interface (CLI)

### cowork

**Description**: AI驱动的软件开发编排系统命令行接口

**Source File**: `crates/cowork-cli/src/main.rs:16-75`

**Arguments**:

- `config` (string): optional - 配置文件路径 (default: `config.toml`)
- `verbose` (boolean): optional - 启用详细日志输出
- `stream` (boolean): optional - 启用LLM流式输出（实时显示AI思考过程）

**Options**:

- `config, c`(string): optional - 配置文件路径
- `verbose, v`(boolean): optional - 启用详细日志输出
- `stream, s`(boolean): optional - 启用LLM流式输出

**Usage Examples**:

```bash
cowork new "开发一个在线待办事项应用"
```

```bash
cowork resume --base session-1234567890
```

```bash
cowork revert --from design
```

```bash
cowork modify "添加用户认证功能" --base session-1234567890
```

```bash
cowork status --sessions
```

```bash
cowork init
```

### new

**Description**: 创建新项目

**Source File**: `crates/cowork-cli/src/main.rs:79-84`

**Arguments**:

- `idea` (string): required - 项目创意/描述

**Usage Examples**:

```bash
cowork new "开发一个在线待办事项应用"
```

### resume

**Description**: 恢复现有项目

**Source File**: `crates/cowork-cli/src/main.rs:86-95`

**Arguments**:

- `base` (string): optional - 从特定会话ID恢复（可选），如果省略，默认使用最新成功会话

**Options**:

- `base, b`(string): optional - 从特定会话ID恢复

**Usage Examples**:

```bash
cowork resume --base session-1234567890
```

### revert

**Description**: 从特定阶段回滚并重启项目

**Source File**: `crates/cowork-cli/src/main.rs:97-104`

**Arguments**:

- `from` (string): required - 重启的阶段（prd, design, plan, coding, check, delivery）

**Options**:

- `from, f`(string): optional - 重启的阶段

**Usage Examples**:

```bash
cowork revert --from design
```

### modify

**Description**: 对现有项目进行增量修改

**Source File**: `crates/cowork-cli/src/main.rs:106-115`

**Arguments**:

- `idea` (string): required - 变更创意/描述
- `base` (string): optional - 基础会话ID（默认最新成功会话）

**Options**:

- `base, b`(string): optional - 基础会话ID

**Usage Examples**:

```bash
cowork modify "添加用户认证功能" --base session-1234567890
```

### status

**Description**: 显示项目状态

**Source File**: `crates/cowork-cli/src/main.rs:117-123`

**Arguments**:

- `sessions` (boolean): optional - 显示所有会话

**Options**:

- `sessions, s`(boolean): optional - 显示所有会话

**Usage Examples**:

```bash
cowork status --sessions
```

### init

**Description**: 初始化配置文件

**Source File**: `crates/cowork-cli/src/main.rs:125-127`

**Usage Examples**:

```bash
cowork init
```

## Integration Suggestions

### 配置管理

本地开发环境集成配置管理

**Example Code**:

```
// 创建配置文件示例
[llm]
api_base_url = "http://localhost:8000/v1"
api_key = "your-api-key-here"
model_name = "gpt-4"

// 环境变量配置示例
export LLM_API_BASE_URL="http://localhost:8000/v1"
export LLM_API_KEY="your-api-key"
export LLM_MODEL_NAME="gpt-4"
```

**Best Practices**:

- 使用配置文件管理LLM API凭据，避免硬编码
- 在开发环境中设置合理的流式输出和日志级别
- 为每个项目创建独立的配置文件和会话管理
- 定期备份项目索引和会话数据

### 会话管理

项目生命周期和会话管理集成

**Example Code**:

```
// 会话管理示例
let session_id = format!("session-{}", chrono::Utc::now().timestamp());
let mut index = init_project_index("project_name")?;
let session_record = SessionRecord {
    session_id: session_id.clone(),
    session_type: SessionType::New,
    created_at: chrono::Utc::now(),
    status: SessionStatus::InProgress,
    input_description: idea.clone(),
};
index.add_session(session_record);
```

**Best Practices**:

- 使用结构化会话ID确保唯一性和可追溯性
- 为每个项目创建独立的.cowork目录
- 实现文件指纹检测机制跟踪项目变更
- 定期清理无效会话数据

### 版本控制

增量修改和版本控制集成

**Example Code**:

```
// 增量修改示例
let before_files = collect_project_file_fingerprints()?;
// ... 执行修改 ...
let after_files = collect_project_file_fingerprints()?;
let (added_files, modified_files, deleted_files) = diff_project_files(&before_files, &after_files);

let mut patch = PatchMetadata::new(session_id.clone(), base_session_id.clone());
patch.added_files = added_files;
patch.modified_files = modified_files;
patch.deleted_files = deleted_files;
```

**Best Practices**:

- 实现增量修改的文件差异检测机制
- 为每个修改会话保存补丁元数据
- 支持多种恢复策略（最新成功、指定会话、最新进行中）
- 提供变更影响分析工具


---

**Analysis Confidence**: 9.5/10
