# System Boundary Interface Documentation

This document describes the system's external invocation interfaces, including CLI commands, API endpoints, configuration parameters, and other boundary mechanisms.

## Command Line Interface (CLI)

### cowork

**Description**: AI驱动的多智能体软件开发系统的主命令，提供交互式模式和子命令功能

**Source File**: `crates/cowork-cli/src/main.rs`

**Arguments**:

- `command` (enum): optional - 子命令选项：Resume（恢复会话）、Inspect（检查会话）、Export（导出会话）
- `config` (string): optional - 模型配置文件路径（TOML格式），默认值为'项目材料/大模型配置说明.md'

**Options**:

- `config`(string): optional - 指定模型配置文件路径 (default: `项目材料/大模型配置说明.md`)

**Usage Examples**:

```bash
cowork # 进入交互式模式，创建新会话
```

```bash
cowork resume abc123 # 恢复会话ID为abc123的会话
```

```bash
cowork inspect abc123 # 检查会话abc123的工件和状态
```

```bash
cowork export abc123 # 导出会话abc123的最终交付物
```

```bash
cowork --config custom_config.toml # 使用自定义配置文件
```

## API Interfaces

### N/A N/A - 当前主要为CLI工具，无HTTP API端点

**Description**: 系统当前主要通过命令行界面交互，Human-in-the-Loop控制器提供程序化交互接口

**Source File**: `crates/cowork-core/src/hitl/mod.rs`

## Router Routes

### N/A - 无Web路由功能

**Description**: 系统为命令行工具，不涉及Web路由

**Source File**: `N/A`

## Integration Suggestions

### CLI集成

将Cowork CLI集成到现有开发工作流中，支持自动化脚本调用和CI/CD流水线集成

**Example Code**:

```
#!/bin/bash
# 自动化开发流程示例
SESSION_ID=$(cowork --config production.toml | grep 'Session created:' | awk '{print $3}')
echo "会话创建成功: $SESSION_ID"

# 等待会话完成
while true; do
    STATUS=$(cowork inspect $SESSION_ID | grep '当前阶段:' | awk '{print $2}')
    if [ "$STATUS" = "Completed" ]; then
        echo "会话完成"
        break
    fi
    sleep 30
done

# 导出交付物
cowork export $SESSION_ID
```

**Best Practices**:

- 使用版本控制的配置文件管理LLM API密钥和端点
- 为不同环境（开发、测试、生产）创建独立的配置文件
- 将会话ID存储在持久化存储中以支持恢复操作
- 定期清理过期的会话数据以释放存储空间

### 配置管理集成

集成环境变量和配置文件管理，支持灵活的部署配置

**Example Code**:

```
use cowork_core::ModelConfig;

// 从文件加载配置（首选）
let config = ModelConfig::from_file("config.toml").unwrap_or_else(|_| {
    // 文件加载失败时回退到环境变量
    ModelConfig::from_env().expect("配置加载失败")
});

// 在应用程序中使用配置
println!("LLM模型: {} at {}", config.llm.model_name, config.llm.api_base_url);
```

**Best Practices**:

- 敏感信息（API密钥）优先使用环境变量存储
- 提供配置模板文件（如config.toml.example）供参考
- 实现配置验证机制确保必需参数正确设置
- 支持配置热重载以支持运行时配置更新

### Human-in-the-Loop集成

集成人工干预控制器，支持复杂的交互式工作流

**Example Code**:

```
use cowork_core::hitl::HitlController;

let hitl = HitlController::new();

// 收集用户输入
let user_input = hitl.input("请输入项目需求描述:")?;

// 确认操作
let confirmed = hitl.confirm("是否继续执行代码生成?")?;

// 审查JSON内容
if let Some(modified) = hitl.review_and_edit_json("设计文档", &design_data)? {
    // 用户修改了内容
    let updated_design: Design = serde_json::from_str(&modified)?;
}

// 收集反馈
let feedback = hitl.collect_feedback("请提供改进建议:")?;
```

**Best Practices**:

- 为关键决策点设置人工确认环节
- 提供有意义的默认值和清晰的提示信息
- 实现输入验证和错误恢复机制
- 记录用户交互历史用于流程优化


---

**Analysis Confidence**: 9.2/10
