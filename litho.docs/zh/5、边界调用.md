# System Boundary Interface Documentation

This document describes the system's external invocation interfaces, including CLI commands, API endpoints, configuration parameters, and other boundary mechanisms.

## Command Line Interface (CLI)

### new

**Description**: 启动一个新项目

**Source File**: `crates/cowork-cli/src/main.rs`

**Arguments**:

- `idea` (string): required - 项目想法/描述

**Options**:

- `config, c`(string): optional - 配置文件路径 (default: `config.toml`)
- `verbose, v`(boolean): optional - 启用详细日志
- `stream, s`(boolean): optional - 启用LLM流式输出（实时显示AI思考过程）

**Usage Examples**:

```bash
cowork new "创建一个在线试卷生成系统"
```

```bash
cowork new "开发一个简单的待办事项应用"
```

### resume

**Description**: 恢复现有项目

**Source File**: `crates/cowork-cli/src/main.rs`

**Arguments**:

- `base` (string): optional - 基于特定会话ID恢复（可选），如省略则默认使用最新成功会话

**Options**:

- `config, c`(string): optional - 配置文件路径 (default: `config.toml`)
- `verbose, v`(boolean): optional - 启用详细日志
- `stream, s`(boolean): optional - 启用LLM流式输出

**Usage Examples**:

```bash
cowork resume
```

```bash
cowork resume --base session-1234567890
```

### revert

**Description**: 从特定阶段恢复项目

**Source File**: `crates/cowork-cli/src/main.rs`

**Arguments**:

- `from` (string): required - 重新开始的阶段（prd, design, plan, coding, check, delivery）

**Options**:

- `config, c`(string): optional - 配置文件路径 (default: `config.toml`)
- `verbose, v`(boolean): optional - 启用详细日志
- `stream, s`(boolean): optional - 启用LLM流式输出

**Usage Examples**:

```bash
cowork revert --from coding
```

```bash
cowork revert --from auto
```

### modify

**Description**: 对现有项目进行增量修改

**Source File**: `crates/cowork-cli/src/main.rs`

**Arguments**:

- `idea` (string): required - 变更想法/描述
- `base` (string): optional - 基础会话ID（默认使用最新成功会话）

**Options**:

- `config, c`(string): optional - 配置文件路径 (default: `config.toml`)
- `verbose, v`(boolean): optional - 启用详细日志
- `stream, s`(boolean): optional - 启用LLM流式输出

**Usage Examples**:

```bash
cowork modify "添加用户登录功能"
```

```bash
cowork modify "优化界面布局" --base session-1234567890
```

### status

**Description**: 显示项目状态

**Source File**: `crates/cowork-cli/src/main.rs`

**Arguments**:

- `sessions` (boolean): optional - 显示所有会话

**Usage Examples**:

```bash
cowork status
```

```bash
cowork status --sessions
```

### init

**Description**: 初始化配置文件

**Source File**: `crates/cowork-cli/src/main.rs`

**Usage Examples**:

```bash
cowork init
```

## API Interfaces

### POST 自定义OpenAI兼容API端点

**Description**: LLM客户端配置接口，用于创建支持OpenAI兼容API的LLM客户端

**Source File**: `crates/cowork-core/src/llm/config.rs`

**Request Format**: HTTP请求体包含API密钥和模型参数

**Response Format**: JSON格式的LLM响应

**Authentication**: API Key认证

## Integration Suggestions

### 配置管理

LLM配置管理集成最佳实践

**Example Code**:

```
let config = ModelConfig::from_file("config.toml").unwrap_or_else(|_| ModelConfig::from_env().unwrap());
let llm_client = create_llm_client(&config.llm)?;
```

**Best Practices**:

- 使用配置文件管理API密钥和模型设置，避免硬编码敏感信息
- 实现速率限制机制，确保API调用频率在合理范围内
- 配置环境变量作为配置文件的后备方案
- 为不同的开发环境设置不同的配置模板

### CLI集成

命令行界面集成指南

**Example Code**:

```
let cli = Cli::parse();
let enable_stream = cli.stream;
match cli.command {
    Commands::New { idea } => cmd_new(idea, &config, enable_stream).await?,
    Commands::Resume { base } => cmd_resume(base, &config, enable_stream).await?,
    // ... 其他命令处理
}
```

**Best Practices**:

- 使用全局参数（--config, --verbose, --stream）统一管理命令行选项
- 实现健壮的错误处理机制，提供清晰的错误信息
- 使用会话ID跟踪项目状态，支持中断恢复
- 实现文件指纹机制，跟踪项目文件变化

### 架构设计

系统架构设计集成指导

**Example Code**:

```
// 设计阶段强调简洁性
const DESIGN_ACTOR_INSTRUCTION: &str = r#"
# CRITICAL PRINCIPLE: SIMPLICITY & MINIMAL ARCHITECTURE
**The architecture MUST be simple and use minimal components:**
- ✅ Use simplest tech stack that works
- ✅ Minimize number of components (2-4 is ideal, 6 is maximum)
- ✅ Use monolithic architecture when appropriate
"#;
```

**Best Practices**:

- 遵循简洁性原则，限制组件数量在2-4个之间
- 优先使用单体架构，避免不必要的微服务拆分
- 选择简单技术栈，减少外部依赖
- 实现人类参与循环（HITL）机制，关键节点需要人工审核


---

**Analysis Confidence**: 9.5/10
